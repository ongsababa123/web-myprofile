<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
        name='viewport' />
    <title>ตระกร้าของฉัน</title>
    <!--     Fonts and icons     -->
    <link href="../../assets/fontgoogle.css" rel="stylesheet" />
    <link rel="stylesheet" href="../../plugins/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="../../dist/sweetalert/sweetalert2.min.css">
    <!-- CSS Files -->
    <link href="../../assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../../assets/css/paper-kit.css" rel="stylesheet" />
    <!-- CSS Just for demo purpose, don't include it in your project -->
    <link href="../../assets/demo/demo.css" rel="stylesheet" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">

</head>
<style>
    * {
        font-family: 'Kanit', sans-serif;
    }

    .dropdown:hover .dropdown-menu {
        display: block;
    }

    .page-item.active .page-link {
        background-color: #2eb6dd;
        color: white;
        border-color: #2eb6dd;
    }

    .pagination>li>a:hover,
    .pagination>li>a:focus,
    .pagination>li>a:active,
    .pagination>li.active>a,
    .pagination>li.active>span,
    .pagination>li.active>a:hover,
    .pagination>li.active>span:hover,
    .pagination>li.active>a:focus,
    .pagination>li.active>span:focus {
        background-color: #2eb6dd;
        border-color: #2eb6dd;
        color: #FFFFFF;
    }

    .pagination>li>a,
    .pagination>li>span,
    .pagination>li:first-child>a,
    .pagination>li:first-child>span,
    .pagination>li:last-child>a,
    .pagination>li:last-child>span {
        background-color: transparent;
        border: 2px solid #4da3bb;
        border-radius: 20px;
        color: #2eb6dd;
        height: 36px;
        margin: 0 2px;
        min-width: 36px;
        padding: 8px 12px;
        font-weight: 600;
    }
</style>

<body class="landing-page sidebar-collapse">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top bg-danger">
        <div class="container">
            <div class="navbar-translate">
                <a class="navbar-brand" href="./home.html" rel="tooltip" title="Coded by Creative Tim"
                    data-placement="bottom" style="font-size: medium; font-family: kanit;">
                    ชื่อร้าน
                </a>
                <a class="navbar-brand" href="../../index.html" rel="tooltip" title="Coded by Creative Tim"
                    data-placement="bottom" style="font-size: medium; font-family: kanit;">
                    Portfolio
                </a>
                <button class="navbar-toggler navbar-toggler" type="button" data-toggle="collapse"
                    data-target="#navigation" aria-controls="navigation-index" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-bar bar1"></span>
                    <span class="navbar-toggler-bar bar2"></span>
                    <span class="navbar-toggler-bar bar3"></span>
                </button>
            </div>
            <div class="collapse navbar-collapse justify-content-end" id="navigation">
                <ul class="navbar-nav">
                    <li class="nav-item dropdown" id="dropdown">
                        <a href="#" id="navbarDropdownMenu" data-toggle="dropdown" aria-haspopup="true"
                            style="font-size: medium; font-family: kanit;" aria-expanded="false"
                            class="nav-link">รายละเอียด</i></a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenu">
                            <a class="dropdown-item" style="font-size: medium; font-family: kanit;">
                                1 : ข้อจำกัดในการเช่าหนังสือ 7 เล่ม / ครั้ง
                            </a>
                            <a class="dropdown-item" style="font-size: medium; font-family: kanit;">
                                2 : หากลูกค้าทำหนังสือหายปรับตามราคาหนังสือเป็น 5 เท่า
                            </a>
                            <a class="dropdown-item" style="font-size: medium; font-family: kanit;">
                                3 : หากเลยกำหนดจะถูกปรับ 20 บาท / เล่ม / วัน
                            </a>
                            <a class="dropdown-item" style="font-size: medium; font-family: kanit;">
                                4 : ค่ามัดจำเล่มละ 100 บาท
                            </a>
                            <a class="dropdown-item" style="font-size: medium; font-family: kanit;">
                                5 : หากจองแล้วไม่เข้ามารับภายใน 2 วัน ที่ทำการจองจะต้องทำการจองใหม่เท่านั้น
                            </a>
                            <a class="dropdown-item" style="font-size: medium; font-family: kanit;">
                                6 : ให้สิทธ์ในการเช่าเพียง 1ครั้ง สูงสุด 7 เล่ม หากยังไม่คืนจะไม่มารถยืมต่อได้
                            </a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a href="./booklist.html" class="nav-link" style="font-size: medium; font-family: kanit;">
                            รายการหนังสือ</a>
                    </li>
                    <li class="nav-item">
                        <a href="./contact.html" class="nav-link" style="font-size: medium; font-family: kanit;">
                            ติดต่อเรา</a>
                    </li>
                    <li class="nav-item">
                        <a href="./login.html" class="btn btn-warning btn-round"
                            style="font-size: medium; font-family: kanit;">เข้าสู่ระบบ</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false" class="btn btn-warning btn-round"><i
                                class="fas fa-user-circle"></i></a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                            <a class="dropdown-item" href="./profile.html"
                                style="font-size: medium; font-family: kanit;">ข้อมูลส่วนตัว <i
                                    class="fas fa-id-card-alt"></i></a>
                            <a class="dropdown-item" href="./cart.html"
                                style="font-size: medium; font-family: kanit;">ตระกร้าสินค้า <i
                                    class="fas fa-shopping-cart"></i></a>
                            <a class="dropdown-item" href="./history.html"
                                style="font-size: medium; font-family: kanit;">ประวัติเช่าหนังสือ <i
                                    class="fas fa-history"></i></a>
                            <a class="dropdown-item" href="./login.html"
                                style="font-size: medium; font-family: kanit;">ออกจากระบบ <i
                                    class="fas fa-sign-out-alt"></i></a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <br>
    <div class="main" style="background-color: #bddce5;">
        <br>
        <div class="page-header page-header-xs" data-parallax="true"
            style="background-image: url('../../dist/img/background.png')">
            <div class="filter"></div>
            <div class="container">
                <div class="motto text-center">
                    <h1 style="font-family: kanit;">ตระกร้าของฉัน</h1>
                    <br />
                    <a href="./booklist.html" class="btn btn-outline-neutral btn-round" style="font-family: kanit;"><i
                            class="fas fa-cart-plus"></i>
                        จองหนังสือเพิ่ม</a>
                </div>
            </div>
        </div>
        <div class="section mb-6" style="background-color: #bddce5;">
            <div class="container ">
                <div class="p-4 border mb-3" style="background-color: white;">
                    <div class="row">
                        <div class="col-lg-1">
                            <div class="center">
                                <div class="form-group">
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="checkbox" value="1">
                                            <span class="form-check-sign">
                                                <span class="check"></span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-11">
                            <div class="row">
                                <div class="col-sm-7">
                                    <h6 class="description" style="font-family: kanit;">ชื่อหนังสือ</h6>
                                    <p class="description" style="font-family: kanit;">
                                        จิตวิทยาสายดาร์ก
                                    </p>
                                </div>
                                <div class="col-sm-3">
                                    <h6 ราคา class="description" style="font-family: kanit;">ราคาเช่า</h6>
                                    100 บาท
                                </div>
                                <div class="col-sm-2">
                                    <h6 ราคา class="description" style="font-family: kanit;">วันที่กดเข้าตระกร้า</h6>
                                    22/04/2021
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-4 border mb-3" style="background-color: white;">
                    <div class="row">
                        <div class="col-lg-1">
                            <div class="center">
                                <div class="form-group">
                                    <div class="form-check">
                                        <label class="form-check-label">
                                            <input class="form-check-input" type="checkbox" value="2">
                                            <span class="form-check-sign">
                                                <span class="check"></span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-11">
                            <div class="row">
                                <div class="col-sm-7">
                                    <h6 class="description" style="font-family: kanit;">ชื่อหนังสือ</h6>
                                    <p class="description" style="font-family: kanit;">
                                        จิตวิทยาสายดาร์ก
                                    </p>
                                </div>
                                <div class="col-sm-3">
                                    <h6 ราคา class="description" style="font-family: kanit;">ราคาเช่า</h6>
                                    100 บาท
                                </div>
                                <div class="col-sm-2">
                                    <h6 ราคา class="description" style="font-family: kanit;">วันที่กดเข้าตระกร้า</h6>
                                    22/04/2021
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-4 border mb-3" style="background-color: white;">
                    <div class="row">
                        <div class="col-lg-4 mt-2">
                            <h6 style="font-family: kanit;">จำนวน : </h6>
                            <p id="quantity"></p>
                        </div>
                        <div class="col-lg-4 mt-2">

                        </div>
                        <div class="col-lg-2">
                            <button class="btn btn-primary btn-round" data-toggle="modal" data-target="#Payment"
                                onclick="loadmodal()" id="button_modal" name="button_modal"
                                style="font-family: kanit;">ดำเนินการจอง</button>
                        </div>
                        <div class="col-lg-2">
                            <button class="btn btn-danger btn-round" onclick="confirm_Alert()" id="button_cancel"
                                name="button_cancel" style="font-family: kanit;">ยกเลิก</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade " id="Payment" tabindex="-1" role="dialog" aria-hidden="false">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header no-border-header text-center">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h1 class="text-muted" style="font-family: kanit;">ยืนยันการจอง</h1>
                    <div class="social-line text-center">
                        <img src="https://via.placeholder.com/300/FFFFFF.png?text=logo" width="10%">
                    </div>
                </div>
                <div class="modal-body" style="font-family: kanit;">
                    <form class="mb-3" id="form_create_history_cart" action="javascript:void(0)" method="post"
                        enctype="multipart/form-data">
                        <div class="form-group">
                            <table class="table" id="cartTable">
                            </table>
                            <table class="table" id="promotionTable">
                                <tr>
                                    <th>โปรโมชั่น :</th>
                                    <td id="details_promotion"></td>
                                    <td></td>
                                    <th>ส่วนลด :</th>
                                    <td id="sum_price_promotion"></td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <td></td>
                                    <td></td>
                                    <th>ค่ามัดจำ :</th>
                                    <td id="sum_price_deposit"></td>
                                </tr>
                                <tr>
                                    <th></th>
                                    <td></td>
                                    <td></td>
                                    <th>ราคารวม(ค่ามัดจำและหักส่วนลด) :</th>
                                    <td id="sum_price"></td>
                                </tr>
                            </table>
                        </div>
                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label class="label-control">เลือกวันที่รับหนังสือ</label>
                                    <input type="text" class="form-control datetimepicker" required
                                        id="rental_date_create" name="rental_date_create" />
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label class="label-control">เลือกวันที่คืน</label>
                                    <input type="text" class="form-control datetimepicker" required
                                        id="return_date_create" name="return_date_create" />
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-block btn-round" style="font-family: kanit;"> จอง</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer bg-danger">
        <div class="container">
            <div class="row">
                <nav class="footer-nav">
                    <ul>
                        <li>
                            <a href="./home.html" style="color: white; font-family: kanit;">ชื่อร้าน</a>
                        </li>
                        <li>
                            <a href="./booklist.html" style="color: white; font-family: kanit;">รายการหนังสือ</a>
                        </li>
                        <li>
                            <a href="./contact.html" style="color: white; font-family: kanit;">ติดต่อเรา</a>
                        </li>
                    </ul>
                </nav>
                <div class="credits ml-auto">
                    <span class="copyright" style="color: white; font-family: kanit;">
                        ©
                        <script>
                            document.write(new Date().getFullYear())
                        </script>, made with <i class="fas fa-heart heart"></i> by Banglem
                    </span>
                </div>
            </div>
        </div>
    </footer>
    <!--   Core JS Files   -->
    <script src="../../assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="../../assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="../../assets/js/core/bootstrap.min.js" type="text/javascript"></script>
    <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
    <script src="../../assets/js/plugins/bootstrap-switch.js"></script>
    <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
    <script src="../../assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
    <!--  Plugin for the DatePicker, full documentation here: https://github.com/uxsolutions/bootstrap-datepicker -->
    <script src="../../assets/js/plugins/moment.min.js"></script>
    <script src="../../assets/js/plugins/bootstrap-datepicker.js" type="text/javascript"></script>
    <!-- Control Center for Paper Kit: parallax effects, scripts for the example pages, etc -->
    <script src="../../assets/js/paper-kit.js?v=2.2.0" type="text/javascript"></script>
    <script src="../../dist/sweetalert/sweetalert2.js"></script>

    <script>
        $("#form_create_history_cart").on('submit', function (e) {
            e.preventDefault();
            action_();
        });
    </script>
    <script>
        var data_dayrent = 5;
        var today = moment().format('YYYY-MM-DD');

        // กำหนดรูปแบบ datetimepicker
        $('.datetimepicker').datetimepicker({
            format: 'YYYY-MM-DD',
            icons: {
                date: "fa fa-calendar",
                up: "fa fa-chevron-up",
                down: "fa fa-chevron-down",
                previous: 'fa fa-chevron-left',
                next: 'fa fa-chevron-right',
                today: 'fa fa-screenshot',
                clear: 'fa fa-trash',
                close: 'fa fa-remove'
            },
            minDate: today // กำหนดให้เลือกวันที่ปัจจุบันเป็นต่ำสุด
        });

        // ตั้งค่า flag ในการตรวจสอบว่ามีการเลือก rental_date_create แล้วหรือไม่
        var rentalDateSelected = false;
        $('#return_date_create').data('DateTimePicker').disable();

        $('#rental_date_create').on('dp.change', function (e) {
            // ดึงข้อมูลวันที่รับหนังสือ
            var rentalDate = e.date;
            var returnDatemin = rentalDate.clone().add(1, 'days');
            var returnDateMax = rentalDate.clone().add(data_dayrent, 'days');
            // คำนวณวันที่คืน 7 วันหลัง
            var maxDate = moment(today).add(2, 'days');

            $('#return_date_create').data('DateTimePicker').minDate(returnDatemin);
            $('#return_date_create').data('DateTimePicker').maxDate(returnDateMax);

            $('#rental_date_create').data('DateTimePicker').maxDate(maxDate);
            // ตั้งค่า flag เมื่อมีการเลือก rental_date_create
            rentalDateSelected = true;
            $('#return_date_create').data('DateTimePicker').enable();

        });
    </script>
    <script>
        var userData = [{
            "status_rental": 1
        }]
        var cart_check = [];
        function cart_check_length(value) {
            if (cart_check.length === 0) {
                $("#button_cancel").prop("disabled", true);
                $("#button_modal").prop("disabled", true);
            } else {
                if (userData[0].status_rental == 2 || userData[0].status_rental == 3) {
                    $("#button_modal").prop("disabled", true);
                    $("#button_cancel").prop("disabled", false);
                } else {
                    $("#button_cancel").prop("disabled", false);
                    $("#button_modal").prop("disabled", false);
                }
            }
        }
        var StockIds = [];
        $(document).ready(function () {
            cart_check_length(cart_check);
            $('.form-check-input').on('change', function () {
                var value = $(this).val();
                if ($(this).is(':checked')) {
                    cart_check.push(value);
                } else {
                    cart_check = cart_check.filter(function (item) {
                        return item !== value;
                    });
                }
                $('#quantity').text(cart_check.length);
                cart_check_length(value);
            });
        });
    </script>
    <script>
        function loadmodal() {
            $("#cartTable").empty();
            var count = 0;
            var sum_rental_price = 0;
            var sum_book_price = 0;
            var id_book_check = '';
            var id_stock_book = '';
            var selectedid_book = [];
            var id_user = 1;
            cart_check.forEach(element => {
                $("#cartTable").append(
                    `<tr>
                        <th>ลำดับ : </th>
                        <td>${count += 1}</td>
                        <th>ชื่อหนังสือ : </th>
                        <td>จิตวิทยาสายดาร์ก</td>
                        <td></td>
                        <th>ราคาหนังสือ : </th>
                        <td>100 บาท</td>
                        <th>ราคาเช่า : </th>
                        <td>100 บาท</td>
                    </tr>`
                );
                id_book_check += 1 + ',';
                id_stock_book += 1 + ',';
                selectedid_book.push(1);

                sum_rental_price += parseInt(100);
                sum_book_price += parseInt(100);
            });
            $(".modal-body #name_user_create").val(id_user);
            $(".modal-body #cart_id").val(cart_check);
            $(".modal-body #name_book_create__").val(id_book_check.slice(0, -1));
            $(".modal-body #id_stock_book").val(id_stock_book.slice(0, -1));

            $("#cartTable").append(
                `<tr>
                    <th></th>
                    <th></th>
                    <td></td>
                    <td></td>
                    <td></td>
                    <th>ราคาหนังสือรวม :</th>
                    <td>${sum_book_price} บาท</td>
                    <th>ราคาเช่ารวม :</th>
                    <td>${sum_rental_price} บาท</td>
                </tr>`
            );
            $("#details_promotion").html("ไม่มีส่วนลดโปรโมชั่น");
            $("#sum_price_promotion").html('0 บาท');
            $("#sum_price_deposit").html('100 บาท');
            $("#sum_price").html('100 บาท');
        }
    </script>
    <script>
        function action_(url, form) {
            Swal.fire({
                title: "ยืนยันการจองสำเร็จ",
                icon: 'success',
                showConfirmButton: false,
                allowOutsideClick: false
            });
            setTimeout(() => {
                window.location.reload();
            }, 2000);
        }
    </script>
</body>

</html>